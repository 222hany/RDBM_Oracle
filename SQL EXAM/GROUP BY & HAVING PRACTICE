//1. GROUP BY와 HAVING을 사용하여 직원수가 3명 이상인 부서의 부서 번호와 직원 수 찾기
SELECT DNO, COUNT(*) AS NUM_EMP FROM EMPLOYEE GROUP BY DNO
HAVING COUNT(*) >= 3;
//2. 각 부서에서 가장 높은 급여를 받는 직원 찾기
SELECT DNO, MAX(SALARY) FROM EMPLOYEE GROUP BY DNO;x(salary);
//3. 급여 중간값이 3500 이상인 부서 찾기 HAVING MEDIAN(SALARY) >= 3500;
SELECT DNO, MEDIAN(SALARY) AS MED_SAL FROM EMPLOYEE GROUP BY DNO
HAVING MEDIAN(SALARY) >= 3500;
//4. 부서별로 직원 수가 2명 이상인 경우 찾기
SELECT DNO, COUNT(*) AS NUM_EMP FROM EMPLOYEE GROUP BY DNO
HAVING COUNT(*) >= 2;
//5. 직책별로 직원 수가 2명 이상인 경우 찾기
SELECT JOB, COUNT(*) AS NUM_EMP FROM EMPLOYEE GROUP BY JOB
HAVING COUNT(*) >= 2;
//6. 모든 부서의 평균 급여를 구하기
SELECT DNO, AVG(SALARY) AS AVG_SAL FROM EMPLOYEE GROUP BY DNO;
//7. 급여가 4000 이상인 직원 수를 찾기
SELECT COUNT(*) AS OVER_4000 FROM EMPLOYEE WHERE SALARY >= 4000;
//8. 부서별로 가장 높은 급여 찾기
SELECT DNO, MAX(SALARY) AS MAX_SAL FROM EMPLOYEE GROUP BY DNO;
//9. 부서별로 직원 수가 3명 이상인 부서 찾기
SELECT DNO, COUNT(*) AS NUM_EMP FROM EMPLOYEE GROUP BY DNO
HAVING COUNT(*) >= 3;
//10. 부서별로 직원 수가 0인 부서 찾기
SELECT DNO, COUNT(*) AS NUM_EMP FROM EMPLOYEE GROUP BY DNO
HAVING COUNT(*) = 0;
//11. 부서별로 급여 합계를 구하고, 합계가 20000 이상인 부서 찾기
SELECT DNO, SUM(SALARY) AS SUM_SAL FROM EMPLOYEE GROUP BY DNO
HAVING SUM(SALARY) >= 20000;
//12. 각 부서에서 가장 오래된 직원 찾기
SELECT DNO, MAX(HIREDATE) FROM EMPLOYEE GROUP BY DNO;
//13. 부서별로 직원의 직무 수 찾기
SELECT DNO, COUNT(JOB) AS NUM_JOB FROM EMPLOYEE GROUP BY DNO;
//14. 급여가 평균 급여보다 높은 직원 찾기
SELECT ENAME AS OVER_AVG_SAL FROM EMPLOYEE WHERE SALARY >= (SELECT AVG(SALARY) FROM EMPLOYEE);
//15. 부서별로 급여 평균보다 높은 직원 수 찾기
SELECT DNO, COUNT(*) FROM EMPLOYEE WHERE SALARY >= (SELECT AVG(SALARY) FROM EMPLOYEE)GROUP BY DNO;
//16. 부서별로 최소 급여가 3000 이상인 직원 찾기
SELECT ENAME AS OVER_3000 FROM EMPLOYEE WHERE SALARY >= 3000;
//17. 부서별로 급여 합계가 10000 이상이고 직원 수가 2명 이상인 부서 찾기
SELECT DNO, SUM(SALARY), COUNT(*) FROM EMPLOYEE GROUP BY DNO
HAVING SUM(SALARY) >= 10000 AND COUNT(*) >= 2;
//18. 부서별로 직원의 입사일자가 2023-01-01 이후인 직원 수 찾기
SELECT DNO, COUNT(*) FROM EMPLOYEE WHERE HIREDATE >= TO_DATE('2023-01-01','YYYY-MM-DD')GROUP BY DNO;
//19. 급여가 가장 높은 직원 찾기
SELECT ENAME, SALARY FROM EMPLOYEE WHERE SALARY = (SELECT MAX(SALARY)FROM EMPLOYEE);
//20. 급여가 가장 높은 직무 찾기
SELECT JOB, SALARY FROM EMPLOYEE WHERE SALARY = (SELECT MAX(SALARY)FROM EMPLOYEE);
